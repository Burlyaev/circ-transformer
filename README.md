# circ-transformer


-----------------------------------------------------------------------------
Short describption of the SW functionality
-----------------------------------------------------------------------------
Project EAA.

It can be opened with MS Visual Studio 2015 ( referred as VS).

1) Program starts with main (Program.fs) that has calls to itcSynth and to synth2Excel.
	- itcSynth - reads the original netlists, makes the transformations, and saves the transformed  circuits in low-level Verilog into separate folders. 
	- synth2Excel - exports to Excel plots 

----------------------------------------------------------------------------------
In details: itcSynth
----------------------------------------------------------------------------------
It takes as an argument list of lists. The argument identifies the memory cells with voters for the all benchmark circuits. For simplicity, the argument ["~~FTMR"] means that voters should be introduced after each memory cells  (no voters at primary outputs). Voters after memory cells not only triplicated-voters in TMR, but also voting mechanisms for time-redundant applications.
The function body of itcSynth is located in allCirSynth.fs:

itcFolder is the folder with original circuit benchmarks (.bench format) (here: ..\itc). Currently, I put in itc all used circuits (without repetition, with an explicit reset line). Some of the ITC bechmarks are not there- but can be found with .hdl and some other formats.

See comments for details of itcSynth. But the main function is cirSynth.

cirSynth takes that a path to each of the circuit files and the associated list of voters to be introduced for this circuit during the transfromation. It reads the files created as Verilog files of the original circuits ( after translation .bench format to .v Verilog format). It also generates the transfromed circuits in Verilog and save this transformed circuits to seprate files in separate folders (different for each transfromation type).

cirSynth is given also in allCirSynth.fs file.
	- allMemL exptracts the names of all memory cells
	- voterL contains the memory cell after which we introduce voters
	- function cir2verilog returns the verilog version fo original .bench format. its type is list of string lists. Generally, all transfromations and translations to verilog lead to two verilog files: top and bottom. So the length of tmrFiles is two (two list of strings= two files) as well as the length of other variables that contains transfromed circuit description (ttrFiles. tddFiles, etc).
	- after all transfromations are perfomed and saved in varibales (list of string lists), they are saved into files in the second part of cirSynth function (with the functions wrCirDesing).
	
wrCirDesign (definition is in genTcl.fs)
	- calls genCirFiles that explicitely distinguished between top and bottom circuit level. Why do we need to levels? Because in bottom level we substitute memory cells with memory block (for exampl in DTR transformation) and at the top level we interconenct the control block, input/output buffers, and the circuit with memory block as design components. Bottom level contains the description of the combinational circuit and memory cells (that are substituted in the case of time-redudant transfromations).
	
		genCirFiles saves the files to different sub-folders in the debugging directory
		(..\project\bin\Debug)
		
		cpSynth takes the saved files from debugging directory and copies them to the folders where the files will be synthesized into Synopsys projects, in particular:
		(..\synthRes)
		
		genBatCall add to the corresponding folder with synthesis project .bat file that calls synopsys tool providing to it the generarated .tcl script (.tcl script is generated by the next function genTclF)
	
		exeCmd (tclP) - applies synopsys synthesis tool to the given folder where it follows .tcl directives to syntheseze the circuit of 2 level (top and bottom) with the predefined components (memory blocks, control block). all subcomponents can be found in the corresponding sub-folders of: 
		(..\project\bin\Debug)
		
		As soon as synthesis in a particular folder is finished, the function readSRR (still genTcl.fs file) extracts from the .srr log-files the results of synthesis: HW size and frequency saving it to the same forder of .report extention
		
----------------------------------------------------------------------------------
In details: synth2Excel
----------------------------------------------------------------------------------
Functions reads all files of .report format in sub-folders of sythRes folder collecting the synhtesis results (required HW resources and max frequency).
It automatically fills 2 Excel Tables: for HW and for Frequency

if the synthesis was not succesful - HW will will be zero and frequency will be negative (-10). Since the benchmark is big- I often interrupted to synthesis of the whole bechmark when I wanted to look at the plots. So if you have already synthesised all needed circuits you comment out in main function itcSynth to prevent re-synthesis and directly generate Excel plots. Or if the transfromation is updated just comment out inside cirSynth the transfromations that were previously done and don't require re-syntheis. It will save some time instead of re-synthesizing the whole benchmark from the begininng.

----------------------------------------------------------------------------------
TO RUN
----------------------------------------------------------------------------------
Just click Start button in the top menu. You also can insert breakpouint ans step-through the program to see what is hapenning. The values of variables can be asily seen in MS Visual Studio.
At the and of the run Excel Files open by tehmselves. The whole synthesis of the whole bechmark may take several hours. To check that something is indeed hapenning- you can check how folders in synthRes folder(..\)




P.S.
1) if open Microsoft.Office.Interop.Excel is not found, add to the project reference .dll libraries from the folder project/lib/
2) fileManip.fs contains all absolute and relative pathes to folders for file manimulations. If the framework is relocated- it's worth to check this file
3) folder itc contains benchmark circuits (ITC'99) seleceted for experements - full bechmark (HDL+.bench+ version with and w/o reset) is located in benchmark_suits/ITC99

